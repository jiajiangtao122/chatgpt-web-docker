import{a as N,af as T,ag as ie,ah as fe,c as pe,d as ee,u as me,g as ue,ai as we,aj as be,h as E,ak as xe,al as k,i as ye,r as x,l as C,am as Ce,an as Se,ao as Te,ap as Xe,aq as ke,ar as Be,as as ze,at as Ae,au as Me,av as Ie,Z as he,a6 as _e,aw as Re,ax as Ye,B as F,E as q,I as l,ay as le,az as H,Q as U,D as h,P as K,aA as He,A as Le,M as De,a0 as Ee,C as re,R as D,U as j,aa as oe,N as Q,ab as ce,S as se,aB as Pe,aC as We,aD as Ue,aE as Fe,aF as $e,aG as Oe}from"./index-d35e185e.js";import{a as G}from"./index-93d2c664.js";const Ve=N("alert",`
 line-height: var(--n-line-height);
 border-radius: var(--n-border-radius);
 position: relative;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-color);
 text-align: start;
 word-break: break-word;
`,[T("border",`
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 transition: border-color .3s var(--n-bezier);
 border: var(--n-border);
 pointer-events: none;
 `),ie("closable",[N("alert-body",[T("title",`
 padding-right: 24px;
 `)])]),T("icon",{color:"var(--n-icon-color)"}),N("alert-body",{padding:"var(--n-padding)"},[T("title",{color:"var(--n-title-text-color)"}),T("content",{color:"var(--n-content-text-color)"})]),fe({originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.9)"}}),T("icon",`
 position: absolute;
 left: 0;
 top: 0;
 align-items: center;
 justify-content: center;
 display: flex;
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 margin: var(--n-icon-margin);
 `),T("close",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 position: absolute;
 right: 0;
 top: 0;
 margin: var(--n-close-margin);
 `),ie("show-icon",[N("alert-body",{paddingLeft:"calc(var(--n-icon-margin-left) + var(--n-icon-size) + var(--n-icon-margin-right))"})]),N("alert-body",`
 border-radius: var(--n-border-radius);
 transition: border-color .3s var(--n-bezier);
 `,[T("title",`
 transition: color .3s var(--n-bezier);
 font-size: 16px;
 line-height: 19px;
 font-weight: var(--n-title-font-weight);
 `,[pe("& +",[T("content",{marginTop:"9px"})])]),T("content",{transition:"color .3s var(--n-bezier)",fontSize:"var(--n-font-size)"})]),T("icon",{transition:"color .3s var(--n-bezier)"})]),Ne=Object.assign(Object.assign({},ue.props),{title:String,showIcon:{type:Boolean,default:!0},type:{type:String,default:"default"},bordered:{type:Boolean,default:!0},closable:Boolean,onClose:Function,onAfterLeave:Function,onAfterHide:Function}),Ze=ee({name:"Alert",inheritAttrs:!1,props:Ne,setup(o){const{mergedClsPrefixRef:i,mergedBorderedRef:s,inlineThemeDisabled:p,mergedRtlRef:g}=me(o),w=ue("Alert","-alert",Ve,we,o,i),S=be("Alert",g,i),e=E(()=>{const{common:{cubicBezierEaseInOut:y},self:v}=w.value,{fontSize:I,borderRadius:_,titleFontWeight:P,lineHeight:d,iconSize:O,iconMargin:B,iconMarginRtl:V,closeIconSize:L,closeBorderRadius:W,closeSize:R,closeMargin:a,closeMarginRtl:t,padding:f}=v,{type:c}=o,{left:Y,right:n}=xe(B);return{"--n-bezier":y,"--n-color":v[k("color",c)],"--n-close-icon-size":L,"--n-close-border-radius":W,"--n-close-color-hover":v[k("closeColorHover",c)],"--n-close-color-pressed":v[k("closeColorPressed",c)],"--n-close-icon-color":v[k("closeIconColor",c)],"--n-close-icon-color-hover":v[k("closeIconColorHover",c)],"--n-close-icon-color-pressed":v[k("closeIconColorPressed",c)],"--n-icon-color":v[k("iconColor",c)],"--n-border":v[k("border",c)],"--n-title-text-color":v[k("titleTextColor",c)],"--n-content-text-color":v[k("contentTextColor",c)],"--n-line-height":d,"--n-border-radius":_,"--n-font-size":I,"--n-title-font-weight":P,"--n-icon-size":O,"--n-icon-margin":B,"--n-icon-margin-rtl":V,"--n-close-size":R,"--n-close-margin":a,"--n-close-margin-rtl":t,"--n-padding":f,"--n-icon-margin-left":Y,"--n-icon-margin-right":n}}),r=p?ye("alert",E(()=>o.type[0]),e,o):void 0,u=x(!0),m=()=>{const{onAfterLeave:y,onAfterHide:v}=o;y&&y(),v&&v()};return{rtlEnabled:S,mergedClsPrefix:i,mergedBordered:s,visible:u,handleCloseClick:()=>{var y;Promise.resolve((y=o.onClose)===null||y===void 0?void 0:y.call(o)).then(v=>{v!==!1&&(u.value=!1)})},handleAfterLeave:()=>{m()},mergedTheme:w,cssVars:p?void 0:e,themeClass:r==null?void 0:r.themeClass,onRender:r==null?void 0:r.onRender}},render(){var o;return(o=this.onRender)===null||o===void 0||o.call(this),C(Ie,{onAfterLeave:this.handleAfterLeave},{default:()=>{const{mergedClsPrefix:i,$slots:s}=this,p={class:[`${i}-alert`,this.themeClass,this.closable&&`${i}-alert--closable`,this.showIcon&&`${i}-alert--show-icon`,this.rtlEnabled&&`${i}-alert--rtl`],style:this.cssVars,role:"alert"};return this.visible?C("div",Object.assign({},Ce(this.$attrs,p)),this.closable&&C(Se,{clsPrefix:i,class:`${i}-alert__close`,onClick:this.handleCloseClick}),this.bordered&&C("div",{class:`${i}-alert__border`}),this.showIcon&&C("div",{class:`${i}-alert__icon`,"aria-hidden":"true"},Te(s.icon,()=>[C(Xe,{clsPrefix:i},{default:()=>{switch(this.type){case"success":return C(Ae,null);case"info":return C(ze,null);case"warning":return C(Be,null);case"error":return C(ke,null);default:return null}}})])),C("div",{class:[`${i}-alert-body`,this.mergedBordered&&`${i}-alert-body--bordered`]},Me(s.header,g=>{const w=g||this.title;return w?C("div",{class:`${i}-alert-body__title`},w):null}),s.default&&C("div",{class:`${i}-alert-body__content`},s))):null}})}});const Qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAELklEQVRYR+2YW2wUZRTH//9vtlCoF9IoIklT3PqgPGi326hoetuaGEhIr9SgCYkkgt2WGOQVCca+GavWdr0GjD4YhG3RB3hply1LQA1tEQIxEXapGI2pEkys9LIzx2ylYWfY6e5sF0oi+7hzzvl+3/9855xvhrjNf7zN+XAHcL4Z+n8o6JWTeYt++W25S596AIZy6TB+n3yo+Nchlk8vmIIVowdXU9c3Q1gDSilBlQwjgBAYFGDvdF58/4milqvZwDpOcXWsb5Uh8hmBqkwXFMhlCN8aX5LXNbRy/T+Z+iXsHAFWRXs3QGQPyLucLDJrK5DgUXdTsxPfjAEro8E3Ce50EtxsKxPTwCPH3U2jTmJkBJgWTnAMxDeGMEoa0xQ+LJQnCD4HYFkCyAC3RdwN3U7gMkpxRTTYrMD91sCJIgCxV5R6O1Jcfy7VwonqLoj9/CqB2kF341qncGkBvRe+ureAWpRgoalCBecMFzcdK24YymZRJz5zprgq1tsJwXYL3CVZGvdGHmwZc7JQtra2gE+f712ep2QUYP714DJhaJrXLqXZQszlZwtYdSHoB9ljVk/ePVrSZFL0ZkAlxzQBVseCT8WhZhRThtFB8plk9Zi/qCi8cv0fNxvKFrDy4oF11NXXIFy2EII4iBcG3Y03VLZT8OqRd5aFPduvOEpxRayvXolxAKB2g6NgEhobBlc1HHYKY7WvHf5wtVAPgegIlbbZ9seUZ7AyFnwewi9pGoUyDmhrB931kfnC1ZwOeKlLP8GZJi6QLSFP2yep4toXSbT3ZQAfX3O6omt8Nhd9r/aHQAUMOQywYBZo5uZD2ThQ2rbPCjlnH6yI9rUryE5DU75ctJaake46Be4DuDjF8dFBNA94/AdtiySVxIlpMlTS8td801o70vMigM9huTda2lhcKHVHPO2HZv/P6LIwX7hk/+qzPSvUJGMkrg8AQYTkroRdXMlE+HH/twsG6BsOdJHYZlaO/lBZ6weOiiSXqs3Gqj0TeAxx+T75DIpgwjC0onD51pQD4JaluPrkR/cpFT9DcoVp84LOgTL/DjtBbglgou+puHwB8lEznPxJw1XSX77VtgizBvQNBw4RMqB7xt4Lc3c8lQKJaQHoO4R8ydz0/7MWoCXk8c85MrMC9J3qaafw/WtQlwXST+F3BnAeYB4obgJ1BJIuG+YtiKAjVOZ/Pd1ZdwzoG+4uBtSPpjaRbhXLcwF3hzytb2TilgVgT5BkYybBrTYC+Rvg5nRpdTRJrIs8+VPXPQXj2i4ItxC4O2NQQUQnN4U9rRcz9nH64p4ceM2lziX5Y4s3KHCdUHwE77ecMkMEp6BwhIa2Z6DslZRvfulgHafYLuCas58WLp2aLCFUga70qxOFU6dPFL2W1feYeaU43Y5z/TxnCuYabMEuC043ckdBp4pZ7f8FE5psOI1g6fwAAAAASUVORK5CYII=",Ge=["width","height"],Je=["width","height"],je=["width","height"],qe=l("div",{class:"loading-gif_"},[l("span"),l("span"),l("span"),l("span"),l("span")],-1),Ke=[qe],et={class:"auth-control_"},tt={class:"range-text"},at=l("div",null,null,-1),nt=l("div",null,null,-1),ot=l("div",null,null,-1),st=[at,nt,ot],it=ee({__name:"App",props:{canvasWidth:{type:Number,default:310},canvasHeight:{type:Number,default:160},show:{type:Boolean,default:!1},puzzleScale:{type:Number,default:1},sliderSize:{type:Number,default:50},range:{type:Number,default:10},imgs:{type:Array,default:null},successText:{type:String,default:"验证通过！"},failText:{type:String,default:"验证失败，请重试"},sliderText:{type:String,default:"拖动滑块完成拼图"}},emits:["success","fail","close"],setup(o,{emit:i}){const s=o;he(()=>{document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",_,!1),document.addEventListener("touchmove",I,{passive:!1}),document.addEventListener("touchend",_,!1),s.show&&(document.body.classList.add("vue-puzzle-overflow"),R())}),_e(()=>{e.timer1&&clearTimeout(e.timer1),document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",_,!1),document.removeEventListener("touchmove",I),document.removeEventListener("touchend",_,!1)});const p=x(),g=x(),w=x(),S=x(),e=Re({mouseDown:!1,startWidth:50,startX:0,newX:0,pinX:0,pinY:0,loading:!1,isCanSlide:!1,error:!1,infoBoxShow:!1,infoText:"",infoBoxFail:!1,timer1:void 0,closeDown:!1,isSuccess:!1,imgIndex:-1,isSubmting:!1});Ye(()=>s.show,a=>{a?(document.body.classList.add("vue-puzzle-overflow"),R()):(e.isSubmting=!1,e.isSuccess=!1,e.infoBoxShow=!1,document.body.classList.remove("vue-puzzle-overflow"))});const r=E(()=>{const a=e.startWidth+e.newX-e.startX;return a<m.value?m.value:a>s.canvasWidth?s.canvasWidth:a}),u=E(()=>Math.round(Math.max(Math.min(s.puzzleScale,2),.2)*52.5+6)),m=E(()=>Math.max(Math.min(Math.round(s.sliderSize),Math.round(s.canvasWidth*.5)),10)),M=()=>{!e.mouseDown&&!e.isSubmting&&(e.timer1&&clearTimeout(e.timer1),i("close"))},$=()=>{e.closeDown=!0},y=()=>{e.closeDown&&M(),e.closeDown=!1},v=a=>{var t;e.isCanSlide&&(e.mouseDown=!0,e.startWidth=((t=p.value)==null?void 0:t.clientWidth)??0,e.newX=a.clientX||a.changedTouches[0].clientX,e.startX=a.clientX||a.changedTouches[0].clientX)},I=a=>{e.mouseDown&&(a.preventDefault(),e.newX=a.clientX||a.changedTouches[0].clientX)},_=()=>{e.mouseDown&&(e.mouseDown=!1,L())},P=(a=!1)=>{var t;if(e.loading&&!a)return;e.loading=!0,e.isCanSlide=!1;const f=g.value,c=w.value,Y=S.value,n=f==null?void 0:f.getContext("2d",{willReadFrequently:!0}),z=c==null?void 0:c.getContext("2d"),Z=Y==null?void 0:Y.getContext("2d");if(!n||!z||!Z){console.error("not found ctx / ctx2 / ctx3");return}const ve=navigator.userAgent.indexOf("Firefox")>=0&&navigator.userAgent.indexOf("Windows")>=0,A=document.createElement("img");if(n.fillStyle="rgba(255,255,255,1)",Z.fillStyle="rgba(255,255,255,1)",n.clearRect(0,0,s.canvasWidth,s.canvasHeight),z.clearRect(0,0,s.canvasWidth,s.canvasHeight),e.pinX=d(u.value+20,s.canvasWidth-u.value-10),e.pinY=d(20,s.canvasHeight-u.value-10),A.crossOrigin="anonymous",A.onload=()=>{const[X,te,ae,ne]=O(A);n.save(),B(n),n.closePath(),ve?(n.clip(),n.save(),n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowColor="#000",n.shadowBlur=3,n.fill(),n.restore()):(n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowColor="#000",n.shadowBlur=3,n.fill(),n.clip()),n.drawImage(A,X,te,ae,ne),Z.fillRect(0,0,s.canvasWidth,s.canvasHeight),Z.drawImage(A,X,te,ae,ne),n.globalCompositeOperation="source-atop",B(n),n.arc(e.pinX+Math.ceil(u.value/2),e.pinY+Math.ceil(u.value/2),u.value*1.2,0,Math.PI*2,!0),n.closePath(),n.shadowColor="rgba(255, 255, 255, .8)",n.shadowOffsetX=-1,n.shadowOffsetY=-1,n.shadowBlur=Math.min(Math.ceil(8*s.puzzleScale),12),n.fillStyle="#ffffaa",n.fill();const ge=n.getImageData(e.pinX-3,e.pinY-20,e.pinX+u.value+5,e.pinY+u.value+5);z.putImageData(ge,0,e.pinY-20),n.restore(),n.clearRect(0,0,s.canvasWidth,s.canvasHeight),n.save(),B(n),n.globalAlpha=.8,n.fillStyle="#ffffff",n.fill(),n.restore(),n.save(),n.globalCompositeOperation="source-atop",B(n),n.arc(e.pinX+Math.ceil(u.value/2),e.pinY+Math.ceil(u.value/2),u.value*1.2,0,Math.PI*2,!0),n.shadowColor="#000",n.shadowOffsetX=2,n.shadowOffsetY=2,n.shadowBlur=16,n.fill(),n.restore(),n.save(),n.globalCompositeOperation="destination-over",n.drawImage(A,X,te,ae,ne),n.restore(),e.loading=!1,e.isCanSlide=!0},A.onerror=()=>{P(!0)},!a&&(t=s.imgs)!=null&&t.length){let X=d(0,s.imgs.length-1);X===e.imgIndex&&(X===s.imgs.length-1?X=0:X++),e.imgIndex=X,A.src=s.imgs[X]}else A.src=V()},d=(a,t)=>Math.ceil(Math.random()*(t-a)+a),O=a=>{const t=a.width/a.height,f=s.canvasWidth/s.canvasHeight;let c=0,Y=0,n=0,z=0;return t>f?(z=s.canvasHeight,n=t*z,Y=0,c=(s.canvasWidth-n)/2):(n=s.canvasWidth,z=n/t,c=0,Y=(s.canvasHeight-z)/2),[c,Y,n,z]},B=a=>{const t=Math.ceil(15*s.puzzleScale);a.beginPath(),a.moveTo(e.pinX,e.pinY),a.lineTo(e.pinX+t,e.pinY),a.arcTo(e.pinX+t,e.pinY-t/2,e.pinX+t+t/2,e.pinY-t/2,t/2),a.arcTo(e.pinX+t+t,e.pinY-t/2,e.pinX+t+t,e.pinY,t/2),a.lineTo(e.pinX+t+t+t,e.pinY),a.lineTo(e.pinX+t+t+t,e.pinY+t),a.arcTo(e.pinX+t+t+t+t/2,e.pinY+t,e.pinX+t+t+t+t/2,e.pinY+t+t/2,t/2),a.arcTo(e.pinX+t+t+t+t/2,e.pinY+t+t,e.pinX+t+t+t,e.pinY+t+t,t/2),a.lineTo(e.pinX+t+t+t,e.pinY+t+t+t),a.lineTo(e.pinX,e.pinY+t+t+t),a.lineTo(e.pinX,e.pinY+t+t),a.arcTo(e.pinX+t/2,e.pinY+t+t,e.pinX+t/2,e.pinY+t+t/2,t/2),a.arcTo(e.pinX+t/2,e.pinY+t,e.pinX,e.pinY+t,t/2),a.lineTo(e.pinX,e.pinY)},V=()=>{const a=document.createElement("canvas"),t=a.getContext("2d");if(!t)return console.error("not found ctx"),"";a.width=s.canvasWidth,a.height=s.canvasHeight,t.fillStyle=`rgb(${d(100,255)},${d(100,255)},${d(100,255)})`,t.fillRect(0,0,s.canvasWidth,s.canvasHeight);for(let f=0;f<12;f++)if(t.fillStyle=`rgb(${d(100,255)},${d(100,255)},${d(100,255)})`,t.strokeStyle=`rgb(${d(100,255)},${d(100,255)},${d(100,255)})`,d(0,2)>1)t.save(),t.rotate(d(-90,90)*Math.PI/180),t.fillRect(d(-20,a.width-20),d(-20,a.height-20),d(10,a.width/2+10),d(10,a.height/2+10)),t.restore();else{t.beginPath();const c=d(-Math.PI,Math.PI);t.arc(d(0,a.width),d(0,a.height),d(10,a.height/2+10),c,c+Math.PI*1.5),t.closePath(),t.fill()}return a.toDataURL("image/png")},L=()=>{e.isSubmting=!0;const a=Math.abs(e.pinX-(r.value-m.value)+(u.value-m.value)*((r.value-m.value)/(s.canvasWidth-m.value))-3);a<s.range?(e.infoText=s.successText,e.infoBoxFail=!1,e.infoBoxShow=!0,e.isCanSlide=!1,e.isSuccess=!0,e.timer1&&clearTimeout(e.timer1),e.timer1=setTimeout(()=>{e.isSubmting=!1,i("success",a)},800)):(e.infoText=s.failText,e.infoBoxFail=!0,e.infoBoxShow=!0,e.isCanSlide=!1,i("fail",a),e.timer1&&clearTimeout(e.timer1),e.timer1=setTimeout(()=>{e.isSubmting=!1,R()},800))},W=()=>{e.infoBoxFail=!1,e.infoBoxShow=!1,e.isCanSlide=!1,e.isSuccess=!1,e.startWidth=m.value,e.startX=0,e.newX=0},R=()=>{e.isSubmting||(W(),P())};return(a,t)=>(F(),q(He,{to:"body"},[l("div",{class:U(["vue-puzzle-vcode",{show_:o.show}]),onMousedown:$,onMouseup:y,onTouchstart:$,onTouchend:y},[l("div",{class:"vue-auth-box_",onMousedown:t[2]||(t[2]=le(()=>{},["stop"])),onTouchstart:t[3]||(t[3]=le(()=>{},["stop"]))},[l("div",{class:"auth-body_",style:H(`height: ${o.canvasHeight}px`)},[l("canvas",{ref_key:"canvas1",ref:g,width:o.canvasWidth,height:o.canvasHeight,style:H(`width:${o.canvasWidth}px;height:${o.canvasHeight}px`)},null,12,Ge),l("canvas",{ref_key:"canvas3",ref:S,class:U(["auth-canvas3_",{show:e.isSuccess}]),width:o.canvasWidth,height:o.canvasHeight,style:H(`width:${o.canvasWidth}px;height:${o.canvasHeight}px`)},null,14,Je),l("canvas",{ref_key:"canvas2",ref:w,class:"auth-canvas2_",width:h(u),height:o.canvasHeight,style:H(`width:${h(u)}px;height:${o.canvasHeight}px;transform:translateX(${h(r)-h(m)-(h(u)-h(m))*((h(r)-h(m))/(o.canvasWidth-h(m)))}px)`)},null,12,je),l("div",{class:U(["loading-box_",{hide_:!e.loading}])},Ke,2),l("div",{class:U(["info-box_",{show:e.infoBoxShow},{fail:e.infoBoxFail}])},K(e.infoText),3),l("div",{class:U(["flash_",{show:e.isSuccess}]),style:H(`transform: translateX(${e.isSuccess?`${o.canvasWidth+o.canvasHeight*.578}px`:`-${o.canvasHeight*.578}px`}) skew(-30deg, 0);`)},null,6),l("img",{class:"reset_",onClick:R,src:Qe})],4),l("div",et,[l("div",{class:"range-box",style:H(`height:${h(m)}px`)},[l("div",tt,K(o.sliderText),1),l("div",{class:"range-slider",ref_key:"rangeSlider",ref:p,style:H(`width:${h(r)}px`)},[l("div",{class:U(["range-btn",{isDown:e.mouseDown}]),style:H(`width:${h(m)}px`),onMousedown:t[0]||(t[0]=f=>v(f)),onTouchstart:t[1]||(t[1]=f=>v(f))},st,38)],4)],4)])],32)],34)]))}});let J;const lt=new Uint8Array(16);function rt(){if(!J&&(J=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!J))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return J(lt)}const b=[];for(let o=0;o<256;++o)b.push((o+256).toString(16).slice(1));function ct(o,i=0){return(b[o[i+0]]+b[o[i+1]]+b[o[i+2]]+b[o[i+3]]+"-"+b[o[i+4]]+b[o[i+5]]+"-"+b[o[i+6]]+b[o[i+7]]+"-"+b[o[i+8]]+b[o[i+9]]+"-"+b[o[i+10]]+b[o[i+11]]+b[o[i+12]]+b[o[i+13]]+b[o[i+14]]+b[o[i+15]]).toLowerCase()}const dt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),de={randomUUID:dt};function ut(o,i,s){if(de.randomUUID&&!i&&!o)return de.randomUUID();o=o||{};const p=o.random||(o.rng||rt)();if(p[6]=p[6]&15|64,p[8]=p[8]&63|128,i){s=s||0;for(let g=0;g<16;++g)i[s+g]=p[g];return i}return ct(p)}const ht={class:"p-4 space-y-5 min-h-[200px]"},vt={class:"space-y-6"},gt={class:"flex items-center space-x-4"},ft={class:"flex-1"},pt={class:"flex items-center space-x-4"},mt={class:"flex-1"},wt={class:"flex items-center space-x-4"},bt={class:"flex-1"},xt={key:0,class:"flex items-center space-x-4"},yt={class:"flex-1"},Ct={class:"flex items-center"},St=ee({__name:"Login",emits:["closeModel"],setup(o,{emit:i}){const s=Le(),{isMobile:p}=De(),g=Ee(),w=x(0),S=x(!1),e=x({email:"",token:"",code:""}),r=x({token:!0,code:!0,submit:!0}),u=x({token:"点击完成验证后发送验证码"}),m=x(null),M=x(null),$=E(()=>{if(e.value.email.length&&!G(e.value.email))return"error"}),y=()=>{r.value.token===!1?S.value=!0:(S.value=!1,r.value.submit=!0),e.value.token.length&&(r.value.code=!1)},v=()=>{S.value=!1},I=()=>{v(),V(),r.value.token=!0,r.value.code=!1,P(),e.value.token="",u.value.token="验证成功，点击重新发送验证码"},_=()=>{v(),r.value.token=!1,r.value.code=!0,r.value.submit=!0,u.value.token="验证失败，请重新验证"},P=()=>{w.value=10,setInterval(()=>{w.value>0?w.value--:r.value.token=!1},1e3)},d=()=>{r.value.token=!G(e.value.email),r.value.submit=!G(e.value.email)||!e.value.code.length},O=()=>{var a,t;G(e.value.email)||(a=m.value)==null||a.focus(),e.value.code.length||(t=M.value)==null||t.focus(),Pe(e.value.email.toLowerCase(),e.value.code).then(f=>{var c;f.status==="Success"?(i("closeModel"),We(f.data.token),s.getUserInfo(),g.success(f.message)):((c=M.value)==null||c.focus(),g.error(f.message))})},B=()=>{e.value.token=ut().replace(/-/g,"").toString()},V=async()=>{B(),await Ue(e.value.email,e.value.token).then(a=>{var t;a.status==="Success"?((t=M.value)==null||t.focus(),g.success(a.message)):g.error(a.message)})},L=x({website:"",register:""}),W=x(!1);async function R(){try{W.value=!0;const{data:a}=await Fe();L.value=a}finally{W.value=!1}}return he(()=>{R()}),(a,t)=>{var f;return F(),re("div",ht,[D(h(Ze),{"show-icon":!1},{default:j(()=>[oe(" 首次认证赠送 "+K(L.value.register.freeTimes)+" 次免费提问次数 ",1)]),_:1}),l("div",vt,[l("div",gt,[l("div",ft,[D(h(Q),{ref_key:"emailRef",ref:m,value:e.value.email,"onUpdate:value":t[0]||(t[0]=c=>e.value.email=c),status:h($),clearable:"",placeholder:"请输入登录邮箱",onKeyup:d},null,8,["value","status"])])]),l("div",pt,[l("div",mt,[D(h(Q),{disabled:r.value.token,placeholder:u.value.token,clearable:"",readonly:"",onClick:y},null,8,["disabled","placeholder"]),D(h(it),{show:S.value,onClose:v,onFail:_,onSuccess:I},null,8,["show"])]),w.value>0?(F(),q(h(ce),{key:0,disabled:"",text:""},{default:j(()=>[oe(K(w.value>0?`(${w.value}s)`:""),1)]),_:1})):se("",!0)]),l("div",wt,[l("div",bt,[D(h(Q),{ref_key:"codeRef",ref:M,value:e.value.code,"onUpdate:value":t[1]||(t[1]=c=>e.value.code=c),disabled:r.value.code,placeholder:(h(p),"请输入邮箱收到的6位验证码"),onKeyup:d},null,8,["value","disabled","placeholder"])])]),((f=L.value.value)==null?void 0:f.register.inviteCode.length)>0?(F(),re("div",xt,[l("div",yt,[D(h(Q),{ref_key:"codeRef",ref:M,value:e.value.code,"onUpdate:value":t[2]||(t[2]=c=>e.value.code=c),placeholder:"注册邀请码",onKeyup:d},null,8,["value"])])])):se("",!0),l("div",Ct,[D(h(ce),{disabled:r.value.submit,block:"",type:"success",onClick:O},{default:j(()=>[oe(" 登录/注册 ")]),_:1},8,["disabled"])])])])}}}),kt=ee({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible"],setup(o,{emit:i}){const s=o,p=x(!1),g=E({get(){return s.visible},set(e){i("update:visible",e)}});function w(){p.value=!0,setTimeout(()=>{p.value=!1},0)}function S(){setTimeout(()=>{g.value=!1},1e3)}return(e,r)=>(F(),q(h(Oe),{show:h(g),"onUpdate:show":r[0]||(r[0]=u=>$e(g)?g.value=u:null),"auto-focus":!1,closable:!1,"mask-closable":!1,"close-on-esc":!1,preset:"dialog",title:"用户认证",class:"min-w-[100px]:","z-index":100},{default:j(()=>[p.value?se("",!0):(F(),q(St,{key:0,onUpdate:w,onCloseModel:S}))]),_:1},8,["show"]))}});export{kt as default};
